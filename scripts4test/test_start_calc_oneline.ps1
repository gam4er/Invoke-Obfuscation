$getdomain = [System.Directoryservices.Activedirectory.Domain]::GetCurrentDomain(); $ComputerDomain = $getdomain | ForEach-Object {$_.DomainControllers} | ForEach-Object { $hEntry= [System.Net.Dns]::GetHostByName($_.Name); New-Object -TypeName PSObject -Property @{ Name = $_.Name; IPAddress = $hEntry.AddressList[0].IPAddressToString; } } | Select-Object Name; Write-Host "Results of availabilyty of DC"; foreach ($HostName in $ComputerDomain) { Test-Connection -ComputerName $HostName.Name -Count 1 | ft -autosize } [string] $cmd = 'cmd /c "start calc"'; Write-Verbose -Message $cmd; Invoke-Command -ScriptBlock ([ScriptBlock]::Create($cmd));